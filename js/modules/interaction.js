const Interaction=(function(){let canvas,world;let mouse=new Vector2(0,0);let isMouseDown=false;let selectedParticle=null;let grabOffset=new Vector2(0,0);function init(_canvas,_world){console.log('[Interaction]InitializingInteractionModule.');canvas=_canvas;world=_world;canvas.addEventListener('mousedown',handleMouseDown);canvas.addEventListener('mousemove',handleMouseMove);canvas.addEventListener('mouseup',handleMouseUp);canvas.addEventListener('mouseout',handleMouseUp);}function updateMousePosition(event){const rect=canvas.getBoundingClientRect();mouse.set(event.clientX-rect.left,event.clientY-rect.top);console.log('[Interaction]MousePositionUpdated:',{x:mouse.x,y:mouse.y});}function handleMouseDown(event){updateMousePosition(event);isMouseDown=true;console.log('[Interaction]MouseDownEvent.');for(const particle of world.particles){const distSq=particle.position.distanceSq(mouse);if(distSq<particle.radius*particle.radius){selectedParticle=particle;const displacement=Vector2.subtract(particle.position,mouse);grabOffset.set(displacement.x,displacement.y);console.log(`[Interaction]ParticleSelected: ${selectedParticle.id}`);break;}}}function handleMouseMove(event){if(!isMouseDown)return;updateMousePosition(event);if(selectedParticle){const targetPosition=Vector2.add(mouse,grabOffset);selectedParticle.position.set(targetPosition.x,targetPosition.y);console.log(`[Interaction]DraggingParticle ${selectedParticle.id}`);}}function handleMouseUp(event){isMouseDown=false;if(selectedParticle){console.log(`[Interaction]MouseUpEvent.Deselected: ${selectedParticle.id}`);selectedParticle=null;}else{console.log('[Interaction]MouseUpEvent.');}}return{init:init,mouse:mouse};})();